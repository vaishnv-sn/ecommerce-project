<style>
  img {
    max-width: 100%;
    /* This rule is very important, please do not ignore this! */
  }

  #canvas {
    height: 600px;
    width: 600px;
    background-color: #ffffff;
    cursor: default;
    border: 1px solid black;
  }
</style>

<div class="container mt-4">
  <div class="row">
    <div class="col-md-6">
      <h2 class="text-center">Add Product</h2>

      <form action="/admin/add-product" enctype="multipart/form-data" method="post">

        <label for="pro_title">Product Title</label>
        <input type="text" name="pro_title" class="form-control mb-4" required>

        <label for="pro_description">Description</label>
        <input type="text" name="pro_description" class="form-control mb-4" required>

        <label for="pro_price">Offer Price</label>
        <input type="number" name="pro_price" class="form-control mb-4" required>

        <label for="pro_offerPrice">Price</label>
        <input type="number" name="pro_offerPrice" class="form-control mb-4" required>

        <label for="image1">Image-1</label>
        <input type="file" id="image1" name="image1" accept="image/*" class="form-control mb-4 js-photo-upload"
          required>

        <label for="image2">Image-2</label>
        <input type="file" id="image2" name="image2" class="form-control mb-4" required>

        <label for="pro_category">Categories</label>
        <select name="pro_category" id="pro_category" class="form-control mb-4" required>
          <option value="" disabled selected hidden>Choose category</option>
          {{#each categories}}
          <option value="{{this.category}}">{{this.category}}</option>
          {{/each}}
        </select>

        <label for="pro_gender">Gender</label>
        <select name="pro_gender" id="pro_gender" class="form-control mb-4" required>
          <option value="" disabled selected hidden>Choose gender</option>
          <option value="male">Male</option>
          <option value="female">Female</option>
          <option value="unisex">Unisex</option>
        </select>

        <label for="pro_stock">Stock count</label>
        <input type="number" name="pro_stock" class="form-control mb-4" required>

        <button type="submit" class="btn btn-success mt-4">Submit</button>

      </form>
    </div>
  </div>
</div>


<!-- Below are a series of inputs which allow file selection and interaction with the cropper api -->
{{!-- <input type="file" id="fileInput" accept="image/*" /> --}}
<script src="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.5.12/cropper.js"
  integrity="sha512-ZK6m9vADamSl5fxBPtXw6ho6A4TuX89HUbcfvxa2v2NYNT/7l8yFGJ3JlXyMN4hlNbz0il4k6DvqbIW5CCwqkw=="
  crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.5.12/cropper.js"
  integrity="sha512-ZK6m9vADamSl5fxBPtXw6ho6A4TuX89HUbcfvxa2v2NYNT/7l8yFGJ3JlXyMN4hlNbz0il4k6DvqbIW5CCwqkw=="
  crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script>
  let cropper;
  let cropperModalId = '#cropperModal';
  let $jsPhotoUploadInput = $('.js-photo-upload');

  $jsPhotoUploadInput.on('change', function () {
    var files = this.files;
    if (files.length > 0) {
      var photo = files[0];

      var reader = new FileReader();
      reader.onload = function (event) {
        var image = $('.js-avatar-preview')[0];
        image.src = event.target.result;

        cropper = new Cropper(image, {
          viewMode: 1,
          aspectRatio: 1,
          minContainerWidth: 400,
          minContainerHeight: 400,
          minCropBoxWidth: 271,
          minCropBoxHeight: 271,
          movable: true,
          ready: function () {
            console.log('ready');
            console.log(cropper.ready);
          }
        });

        $(cropperModalId).modal();
      };
      reader.readAsDataURL(photo);
    }
  });

  $('.js-save-cropped-avatar').on('click', function (event) {
    event.preventDefault();

    console.log(cropper.ready);

    var $button = $(this);
    $button.text('uploading...');
    $button.prop('disabled', true);

    const canvas = cropper.getCroppedCanvas();
    const base64encodedImage = canvas.toDataURL();
    $('#avatar-crop').attr('src', base64encodedImage);
    $(cropperModalId).modal('hide');
  });


</script>